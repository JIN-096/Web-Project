<!DOCTYPE html>
<meta charset="utf-8">

<html>
<meta charset="UTF-8">

<head>
    <script type="text/javascript" src="../static/js/jquery-3.5.0.min.js"></script>
    <link href="../static/css/bootstrap.min.css" rel="stylesheet">
    <link href="../static/css/font.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.8.2/css/all.min.css" />
    <script src="https://www.amcharts.com/lib/4/core.js"></script>
    <script src="https://www.amcharts.com/lib/4/charts.js"></script>
    <script src="https://www.amcharts.com/lib/4/themes/animated.js"></script>
    <title>KNU CSE PUZZLE</title>

    <style>
        body,
        p {
            font-family: "NanumSquareRoundEB";
            animation: fadein 0.5s;
        }

        #banner {
            width: 100%;
            height: 150px;
            max-width: 1400px;
            background-color: lightgray;
            margin-bottom: 1em;
        }

        .infoSection {
            width: 49%;
            max-width: 900px;
            height: 700px;
            border: 1px solid lightgray;
            border-radius: 8px;
            padding: 5px;
        }

        .infoSection_all {
            width: 49%;
            max-width: 900px;
            max-height: 700px;
            border: 1px solid lightgray;
            border-radius: 8px;
            padding: 5px;
        }

        #simple_left {
            float: left;
            width: 100%;
            margin-right: 0.5em;
            height: 100%;
            border-radius: 8px;
            padding: 13px;
            border:1px solid lightgray;
            background-color: rgb(240, 240, 240);
            margin-top:15px;
        }

        #chartdiv {
            width: 100%;
            height: 500px;
        }

        #chartdiv2 {
            width: 100%;
            height: 350px;
        }

        @media (max-width: 991px) {
            .infoSection {
                float: left;
                width: 100%;
                border: 1px solid lightgray;
                padding: 5px;
                margin-bottom: 10px;
            }

            .infoSection_all {
                float: left;
                width: 100%;
                max-width: 900px;
                max-height: 300px;
                border: 1px solid lightgray;
                border-radius: 8px;
                padding: 5px;
            }

            #all_data_table {
                font-size: 11px;
            }

            #simple_left {
                float: left;
                width: 100%;
                height: 100%;
                border-radius: 5px;
                padding: 10px;
                background-color: rgb(240, 240, 240)
            }
        }

        @keyframes fadein {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }
    </style>
</head>

<body>
    <div id="content" style="max-width:1400px; margin:0 auto;">

        <!-- 사용자 졸업 충족 간단 확인 박스 -->
        
        <!-- 상세 학점정보 확인 박스 -->
        <div id="info2" class="infoSection" style="overflow:scroll; float:left">
            <p style="text-align:center; font-size :23px;
            border-radius:8px; padding:5px;
            color:white;
            background-color: rgb(27, 95, 151);">
                상세 학점정보 확인</p>

            <!-- 이수학점 및 평점 메인 -->
            <table class="table table-hover">
                <thead>
                    <th style="font-size:30px; text-align:center" width="50%">이수학점</th>
                    <th style="font-size:30px; text-align:center" width="50%">평점</th>
                </thead>
                <tbody>
                    <tr style="font-size: 23px; text-align:center">
                        <td>
                            <span style="color:teal">{{final_grade[0]}}</span> / 150
                        </td>
                        <td>
                            {{final_grade[1]}} / 4.3
                        </td>
                    </tr>
                </tbody>
            </table>

            <!-- 그래프로 시각화할 자료 -->
            <!-- Abeek 112학점 중 기본소양, 전공기반, 공학전공 학점 -->
            <p style="text-align:center; font-size :18px;
            border-radius:7px; padding:5px;
            color:rgb(19, 23, 48);
            background-color:rgb(233, 233, 233);">
                ABEEK (기본소양, 전공기반, 공학전공) 현황 </p>
            <div id="chartdiv"></div>
            <br><br>
            <!-- Abeek 112학점 중 기본소양, 전공기반, 공학전공 학점 -->
            <p style="text-align:center; font-size :18px;
            border-radius:7px; padding:5px;
            color:rgb(19, 23, 48);
            background-color:rgb(233, 233, 233);">
                ABEEK 필수과목 충족여부 </p>
            <div id="chartdiv2"></div>
        </div>


        <!-- 전체 학점 및 과목 정보 박스 -->
        <div id="info1" class="infoSection_all" style="overflow:scroll; float:right">

            <p style="text-align:center; font-size :23px;
            border-radius:8px; padding:5px;
            color:white;
            background-color: rgb(90, 156, 218);">
                내가 수강한 과목들

                <button id="openButton" class="btn btn-primary" style="width:30px;height:30px;padding:1px;">
                    <i class="fas fa-angle-down fa-2x"></i></button>
                <button id="closeButton" class="btn btn-primary" style="width:30px;height:30px;padding:1px;">
                    <i class="fas fa-angle-up fa-2x"></i></button>
            </p>
            <div id="all_data">
                <table id="all_data_table" class="table table-hover">
                    <thead>
                        <th style="color:teal; text-align:center" width="14%">과목번호</th>
                        <th style="text-align:center" width="20%">개설학과</th>
                        <th style="text-align:center" width="20%">교과목명</th>
                        <th style="text-align:center" width="14%">교과구분</th>
                        <th style="text-align:center" width="9%">학점</th>
                        <th style="text-align:center" width="14%">학기</th>
                        <th style="text-align:center" width="9%">평점</th>
                    </thead>
                    <tbody>
                        {% for tr in grade_array %}
                        <tr>
                            {% for td in tr %}
                            <td style="text-align:center">
                                {{td}}
                            </td>
                            {% endfor %}
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>

        <!-- 졸업요건 설명 텍스트박스 -->
        <div id="simple_left">
            <p style="font-size:14px;">
                ● 졸업 시 총 이수학점은 <span style="color:rgb(26, 26, 224)">150</span>학점을 충족해야 하며,
                그 중에서 ABEEK 이수학점이 <span style="color:rgb(182, 35, 108)">112</span>학점 포함되어야 합니다.
            </p>
            <p style="font-size:14px;">
                ● <span style="color:rgb(182, 35, 108)">ABEEK 112학점</span>은 기본소양 15학점(외국어 제외),
                전공기반 22학점, 공학전공 75학점으로 채워야 합니다.
            </p>
            <p style="font-size:14px;">
                ● ABEEK의 <span style="color:rgb(182, 35, 108)">전공기반, 공학전공</span>에는 학점 충족 수와 관계없이 반드시 수강해야 하는
                <span style="color:rgb(182, 35, 108)">필수과목</span>이 존재합니다.
            </p>
            <p style="font-size:12px;">
                · <span style="color:rgb(182, 35, 108)">전공기반 필수</span> : 수학1, 물리학1, 물리학실험1(or 기초공학물리학실험), 이산수학
            </p>
            <p style="font-size:12px;">
                · <span style="color:rgb(182, 35, 108)">공학전공 필수</span> : 기초프로그래밍(or 프로그래밍기초), 자료구조, 자바프로그래밍, 시스템프로그래밍,
                컴퓨터구조, 운영체제, 알고리즘1
            </p>
            <p style="font-size:14px;">
                ● 공학전공에는 설계 학점이라는 것이 별도로 존재하며, <span style="color:rgb(182, 35, 108)">설계 학점</span>을 부여받는 과목을 <span
                    style="color:rgb(182, 35, 108)">총 16학점</span> 이수해야 합니다.
            </p>
            <p style="font-size:12px;">
                · <span style="color:rgb(182, 35, 108)">필수 설계과목</span> : 기초창의공학설계(설계2학점), 자바프로그래밍(설계2학점),
                시스템프로그래밍(설계2학점),
                종합설계프로젝트1,2(각각 설계 4학점)
            </p>
            <p style="font-size:12px;">
                · 위의 필수 설계과목을 모두 이수하면 14학점이며, 나머지 학점은 다른 설계과목으로 추가 이수하여야 합니다.
            </p>
        </div>


    </div>
    </div>

</body>

<script>
    var $openButton = $('#openButton');
    var $closeButton = $('#closeButton');
    var $all_data = $('#all_data');

    $openButton.hide();

    $openButton.click(function () {
        $all_data.slideDown();
        $closeButton.show();
        $openButton.hide();
    });

    $closeButton.click(function () {
        $all_data.slideUp();
        $openButton.show();
        $closeButton.hide();
    });
</script>

<script>
    am4core.ready(function () {

        // Themes begin
        am4core.useTheme(am4themes_animated);
        // Themes end

        var chart = am4core.create('chartdiv', am4charts.XYChart)

        chart.colors.step = 2;

        chart.legend = new am4charts.Legend()
        chart.legend.position = 'top'
        chart.legend.paddingBottom = 20
        chart.legend.labels.template.maxWidth = 95

        var xAxis = chart.xAxes.push(new am4charts.CategoryAxis())
        xAxis.dataFields.category = 'category'
        xAxis.renderer.cellStartLocation = 0.1
        xAxis.renderer.cellEndLocation = 0.9
        xAxis.renderer.grid.template.location = 0;

        var yAxis = chart.yAxes.push(new am4charts.ValueAxis());
        yAxis.min = 0;

        function createSeries(value, name) {
            var series = chart.series.push(new am4charts.ColumnSeries())
            series.dataFields.valueY = value
            series.dataFields.categoryX = 'category'
            series.name = name

            series.events.on("hidden", arrangeColumns);
            series.events.on("shown", arrangeColumns);

            var bullet = series.bullets.push(new am4charts.LabelBullet())
            bullet.interactionsEnabled = false
            bullet.dy = 30;
            bullet.label.text = '{valueY}'
            bullet.label.fill = am4core.color('#ffffff')

            return series;
        }

        chart.data = [
            {
                category: '기본소양',
                first: {{ final_grade[4]}},
        second: 15,
        },
        {
            category: '전공기반',
            first: {{ final_grade[5]}},
        second: 22,
        },
        {
            category: '공학전공',
            first: {{ final_grade[6]}},
        second: 75,
        },
        {
            category: '합계',
            first: {{ final_grade[4]}} + {{ final_grade[5]}} + {{ final_grade[6]}},
        second: 112,
        }
    ]


        createSeries('first', '현재학점');
    createSeries('second', '필요학점');

    function arrangeColumns() {

        var series = chart.series.getIndex(0);

        var w = 1 - xAxis.renderer.cellStartLocation - (1 - xAxis.renderer.cellEndLocation);
        if (series.dataItems.length > 1) {
            var x0 = xAxis.getX(series.dataItems.getIndex(0), "categoryX");
            var x1 = xAxis.getX(series.dataItems.getIndex(1), "categoryX");
            var delta = ((x1 - x0) / chart.series.length) * w;
            if (am4core.isNumber(delta)) {
                var middle = chart.series.length / 2;

                var newIndex = 0;
                chart.series.each(function (series) {
                    if (!series.isHidden && !series.isHiding) {
                        series.dummyData = newIndex;
                        newIndex++;
                    }
                    else {
                        series.dummyData = chart.series.indexOf(series);
                    }
                })
                var visibleCount = newIndex;
                var newMiddle = visibleCount / 2;

                chart.series.each(function (series) {
                    var trueIndex = chart.series.indexOf(series);
                    var newIndex = series.dummyData;

                    var dx = (newIndex - trueIndex + middle - newMiddle) * delta

                    series.animate({ property: "dx", to: dx }, series.interpolationDuration, series.interpolationEasing);
                    series.bulletsContainer.animate({ property: "dx", to: dx }, series.interpolationDuration, series.interpolationEasing);
                })
            }
        }
    }
    }); // end am4core.ready()
</script>

<script>
    am4core.ready(function () {

        // Themes begin
        am4core.useTheme(am4themes_animated);
        // Themes end

        var chart = am4core.create('chartdiv2', am4charts.XYChart)

        chart.colors.step = 2;

        chart.legend = new am4charts.Legend()
        chart.legend.position = 'top'
        chart.legend.paddingBottom = 20
        chart.legend.labels.template.maxWidth = 95

        var xAxis = chart.xAxes.push(new am4charts.CategoryAxis())
        xAxis.dataFields.category = 'category'
        xAxis.renderer.cellStartLocation = 0.1
        xAxis.renderer.cellEndLocation = 0.9
        xAxis.renderer.grid.template.location = 0;

        var yAxis = chart.yAxes.push(new am4charts.ValueAxis());
        yAxis.min = 0;

        function createSeries(value, name) {
            var series = chart.series.push(new am4charts.ColumnSeries())
            series.dataFields.valueY = value
            series.dataFields.categoryX = 'category'
            series.name = name

            series.events.on("hidden", arrangeColumns);
            series.events.on("shown", arrangeColumns);

            var bullet = series.bullets.push(new am4charts.LabelBullet())
            bullet.interactionsEnabled = false
            bullet.dy = 30;
            bullet.label.text = '{valueY}'
            bullet.label.fill = am4core.color('#ffffff')

            return series;
        }

        chart.data = [
            {
                category: '설계과목',
                first: {{ design_count }},
        second: 16,
        },
        {
            category: '필수과목',
            first: {{ required_count }},
        second: 44,
        },
    ]


        createSeries('first', '현재학점');
    createSeries('second', '필요학점');

    function arrangeColumns() {

        var series = chart.series.getIndex(0);

        var w = 1 - xAxis.renderer.cellStartLocation - (1 - xAxis.renderer.cellEndLocation);
        if (series.dataItems.length > 1) {
            var x0 = xAxis.getX(series.dataItems.getIndex(0), "categoryX");
            var x1 = xAxis.getX(series.dataItems.getIndex(1), "categoryX");
            var delta = ((x1 - x0) / chart.series.length) * w;
            if (am4core.isNumber(delta)) {
                var middle = chart.series.length / 2;

                var newIndex = 0;
                chart.series.each(function (series) {
                    if (!series.isHidden && !series.isHiding) {
                        series.dummyData = newIndex;
                        newIndex++;
                    }
                    else {
                        series.dummyData = chart.series.indexOf(series);
                    }
                })
                var visibleCount = newIndex;
                var newMiddle = visibleCount / 2;

                chart.series.each(function (series) {
                    var trueIndex = chart.series.indexOf(series);
                    var newIndex = series.dummyData;

                    var dx = (newIndex - trueIndex + middle - newMiddle) * delta

                    series.animate({ property: "dx", to: dx }, series.interpolationDuration, series.interpolationEasing);
                    series.bulletsContainer.animate({ property: "dx", to: dx }, series.interpolationDuration, series.interpolationEasing);
                })
            }
        }
    }
    }); // end am4core.ready()
</script>


</html>